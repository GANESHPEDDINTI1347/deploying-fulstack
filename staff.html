<!DOCTYPE html>
<html>
<head>
    <title>Staff Panel</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body>

<!-- Load common script -->
<script src="script.js"></script>

<!-- Role protection -->
<script>
window.onload = function () {
    checkAccess("staff");
};
</script>

<nav class="navbar navbar-dark bg-dark">
    <div class="container-fluid">
        <span class="navbar-brand">Staff Panel</span>
        <button onclick="logout()" class="btn btn-danger">Logout</button>
    </div>
</nav>

<div class="container mt-4">
    <h3>Update Student Details</h3>

    <input id="username" class="form-control mb-2" placeholder="Student Username">
    <input id="attendance" class="form-control mb-2" placeholder="Attendance %">
    <input id="subject" class="form-control mb-2" placeholder="Subject">
    <input id="marks" class="form-control mb-2" placeholder="Marks">

    <button onclick="updateStudent()" class="btn btn-primary">
        Update
    </button>

    <p id="msg" class="mt-3"></p>
<hr class="my-4 border-2 border-dark">

<h4 class="mt-4">Upload Students CSV</h4>

<input type="file" id="csvFile" class="form-control mb-2">

<button onclick="uploadCSV()" class="btn btn-success">
    Upload Students
</button>

<p id="uploadMsg"></p>

    
</div>

<script>
async function updateStudent() {
    const username = document.getElementById("username").value;
    const attendance = document.getElementById("attendance").value;
    const subject = document.getElementById("subject").value;
    const marks = document.getElementById("marks").value;

    const res = await fetch("https://backend-deployment-1-5kgv.onrender.com/updateByUsername", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ username, attendance, subject, marks })
    });

    const data = await res.json();
    document.getElementById("msg").innerText = data.message;
}
</script>

</body>
</html>
